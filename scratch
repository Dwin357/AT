...k, so


the trouble I am having is that things aren't happening at the same time, so an ID field is blank...
my idea is to try and set up a transaction to try and do everything in one go...

I'm muddled right now...  Passengers seems to be working, but trailers isn't --and yet the logic appears the same ?!?





active_support (when required)
  #.days.from_now => spits out the time object w/ appropriate calculation

  #.minutes.ago

I want a validation that tells me if a given resoruce (soldier/truck/trailer) has any other missions ....

so, given a [soldier + mission], I want to validate
  generate a list:  list = soldier.missions.all
    (^-not actually a thing, but maybe it should be)
  if list.any?{ |m|  m.return_at > soldier.mission.step_off_at } || list.any?{ |m|  m.step_of_at < soldier.mission.return_at }
    errors.add(:soldier, "double booking, #{resource.name} already on mission during this time")
  end


class Soldier
  has_many :assignemnts, class_name: "SoldierAssignment"

  def assignments_as_passenger
    assignments.as_passenger
  end

  def assignments_as_driver
    assignments.as_driver
  end

  def assignments_as_assistant_driver
    assignments.as_assistant_driver
  end
end

class SoldierAssignment
  def self.as_passenger
    where(role: "passenger")
  end

  def self.as_driver
    where(role: "driver")
  end

  def self.as_assistant_driver
    where(role: "assistant driver")
  end
end
